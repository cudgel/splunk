# Puppet Name: <%= @title %>
#
<%
  indexers             = scope['::splunk::params::tcpout']
  cacert               = scope['::splunk::params::cacert']
  ciphersuite          = scope['::splunk::params::ciphersuite']
  ecdhcurves           = scope['::splunk::params::ecdhcurves']
  servercertpass       = scope['::splunk::params::servercertpass']
  servercert           = scope['::splunk::params::servercert']
  sslclientcompression = scope['::splunk::params::sslclientcompression']
  sslverify            = scope['::splunk::params::sslverify']
  sslversions          = scope['::splunk::params::sslversions']
  autolb               = scope['splunk::params::autolb']
  autolbfrequency      = scope['splunk::params::autolbfrequency']
  forcetimebasedautolb = scope['splunk::params::forcetimebasedautolb']
-%>
[tcpout]
indexAndForward = false
defaultGroup = <%= indexers['group'] %>

[tcpout:<%= indexers['group'] %>]
autoLBFrequency = <%= autolbfrequency %>
cipherSuite = <%= ciphersuite %>
<% if ecdhcurves != nil -%>
ecdhCurves = <%= ecdhcurves %>
<% end -%>
clientCert = $SPLUNK_HOME/etc/auth/<%= servercert %>
disabled = false
forceTimebasedAutoLB = <%= forcetimebasedautolb %>
server = <% indexers['servers'].each do |server| %><%= server %><%= "," unless server == indexers['servers'].last %><% end %>
sslCommonNameToCheck = <%= indexers['cname'] %>
sslPassword = <%= servercertpass %>
sslVerifyServerCert = <%= sslverify %>
sslVersions = <%= sslversions %>
useClientSSLCompression = <%= sslclientcompression %>
