<%
  cacert = scope['::splunk::params::cacertpath']
  ecdhcurves = scope['::splunk::params::ecdhcurves']
  servercertpass = scope['::splunk::params::servercertpass']
  servercert = scope['::splunk::params::servercertpath']
  ciphersuite = scope['::splunk::params::ciphersuite']
  sslclientcompression = scope['::splunk::params::sslclientcompression']
  sslcompression = scope['::splunk::params::sslcompression']
  sslversions = scope['::splunk::params::sslversions']
  sslverify = scope['::splunk::params::sslverify']
  sslclientcert = scope['::splunk::params::sslclientcert']
  sslnegotiation = scope['::splunk::params::sslnegotiation']
  sslstsheader = scope['::splunk::params::sslstsheader']
-%>

[sslConfig]
allowSslCompression = <%= sslcompression %>
allowSslRenegotiation = <%= sslnegotiation %>
caPath = $SPLUNK_HOME/etc/auth
caCertFile = $SPLUNK_HOME/etc/auth/<%= cacert %>
cipherSuite = <%= ciphersuite %>
<% if ecdhcurves != nil -%>
ecdhCurves = <%= ecdhcurves %>
<% end -%>
enableSplunkdSSL = true
requireClientCert = <%= sslclientcert %>
sendStrictTransportSecurityHeader = <%= sslstsheader %>
serverCert = $SPLUNK_HOME/etc/auth/<%= servercert %>
sslPassword = <%= servercertpass %>
sslVerifyServerCert = <%= sslverify %>
sslVersions = <%= sslversions %>
sslVersionsForClient = <%= sslversions %>
useClientSSLCompression = <%= sslclientcompression %>
useSplunkdClientSSLCompression = <%= sslclientcompression %>
certCreateScript = $SPLUNK_HOME/bin/splunk, createssl, server-cert, 2048
